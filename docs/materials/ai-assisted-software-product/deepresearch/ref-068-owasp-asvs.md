# Deep Research: [68] OWASP ASVS：把安全从口号变成验收项

- Source: https://owasp.org/www-project-application-security-verification-standard/
- Note: ../notes/ref-068-owasp-asvs.md
- Snapshot: ../sources/md/owasp-org-www-project-application-security-verification-standard-50b4bc9ed328.md
## TL;DR
OWASP ASVS (应用安全验证标准) 是一个开放标准，旨在为 Web 应用的技术安全控制提供测试基准和开发需求清单。它将模糊的安全概念转化为可度量、可验收的具体指标，既可作为开发指导，也可作为采购和验收的依据。

## 核心观点
1.  **安全左移的标尺**：ASVS 不仅仅是测试标准，更是开发人员构建安全控制时的需求清单（Requirements for secure development）。
2.  **三个主要用途**：
    *   **度量标准 (Metric)**：作为评估 Web 应用可信度的尺子。
    *   **开发指导 (Guidance)**：告诉开发者具体的安全控制（如防 XSS、SQL 注入）该如何构建。
    *   **采购依据 (Procurement)**：在合同中明确具体的安全验收要求，避免扯皮。
3.  **结构化验证**：采用章.节.条目（如 `1.2.5`）的格式，确保每个安全要求都是原子化、可测试的。
4.  **分级与覆盖**：标准覆盖了广泛的技术控制领域（如输入验证、认证、会话管理等），并允许根据应用风险选择不同的验证严格程度（对应现有笔记中的可落地的分级）。
5.  **版本化管理**：引用需求时必须带上版本号（如 `v5.0.0-1.2.5`），因为安全威胁和防御技术在不断演进。
6.  **生态系统兼容**：ASVS 被 CREST、App Defense Alliance 等机构广泛采用，是行业事实标准。

## 可落地做法

### 1. 面向产品/采购 (Product/Procurement)
*   **合同约束**：在软件外包或采购合同中写入：交付物必须通过 OWASP ASVS v5.0.0 Level X 的验证。
*   **需求明确**：在 PRD 中引用 ASVS 相关章节（如数据保护章节），作为非功能性需求。

### 2. 面向工程开发 (Engineering)
*   **编码规范**：将 ASVS 的开发指导部分转化为内部编码规范（例如：所有操作系统调用必须使用参数化查询，参考 ASVS 1.2.5）。
*   **Code Review**：在代码审查清单中加入 ASVS 的高危项（如注入、XSS 防护）。

### 3. 面向测试/QA (Verification)
*   **验收测试**：使用 ASVS 作为验收测试用例库，逐条验证。
*   **自动化集成**：将可自动化的 ASVS 条目（如 HTTP 头配置、依赖扫描）集成到 CI/CD 流水线中。

## 检查清单（高频核心安全域）

*注：以下基于 ASVS 常见重点领域整理，具体条目编号需对照官方最新版（如 v5.0.0）。*

### 身份认证与会话管理 (Authentication & Session)
- [ ] **密码策略**：是否强制执行了复杂度、长度和轮换策略？
- [ ] **多因素认证 (MFA)**：关键操作或高权限账户是否强制 MFA？
- [ ] **会话超时**：是否设置了合理的空闲超时和绝对超时时间？
- [ ] **Cookie 安全**：Session Cookie 是否标记了 `Secure`, `HttpOnly`, `SameSite`？

### 输入验证与注入防护 (Input Validation & Injection)
- [ ] **SQL 注入**：是否全部使用了参数化查询（Prepared Statements）？
- [ ] **OS 命令注入**：是否避免了直接调用系统命令，或对参数进行了严格的上下文编码（参考 ASVS 1.2.5）？
- [ ] **XSS 防护**：是否对所有用户输入在输出时进行了上下文相关的转义（Escaping）？

### 数据保护与隐私 (Data Protection)
- [ ] **传输加密**：是否全站强制 HTTPS？
- [ ] **敏感数据**：密码、密钥等是否加密存储（禁止明文）？

### 日志与监控 (Logging & Monitoring)
- [ ] **安全审计**：登录失败、权限提升等关键事件是否被记录？
- [ ] **日志脱敏**：日志中是否确保未包含敏感信息（如用户密码、Token）？

## 常见坑与对策

1.  **坑：引用不具体**
    *   **现象**：只说符合 ASVS，没说哪个版本或哪个级别。
    *   **对策**：必须明确格式 `v<version>-<chapter>.<section>.<requirement>`（如 `v5.0.0-1.2.5`）。
2.  **坑：过度依赖工具**
    *   **现象**：认为跑一遍 SAST/DAST 工具就是过了 ASVS。
    *   **对策**：ASVS 很多逻辑漏洞（如越权访问、业务逻辑绕过）无法通过工具全自动扫描，必须保留人工渗透测试或代码审计环节。
3.  **坑：试图全覆盖**
    *   **现象**：对一个内部低风险应用强推最高级别 ASVS 标准，导致成本失控。
    *   **对策**：根据应用风险等级裁剪检查项（Tailoring），可验收比大而全更重要。

## 可用于丰富《AI 辅助软件产品》的写作点

*   **第 5 章（Backend MVP / 后端安全底线）**：
    *   引用 ASVS 作为AI 生成代码的安全基线。提示 Prompt 编写时：请生成符合 OWASP ASVS v5.0 关于 SQL 注入防护的代码。
    *   强调安全是质量属性：在 MVP 阶段就引入 ASVS Level 1 (基础软件安全) 的概念，避免后期重构。
*   **第 11 章（用户与计费 / 认证）**：
    *   在设计用户系统时，直接照搬 ASVS Authentication 章节的要求作为验收标准。
*   **第 18 章（Evaluation / 评测与验收）**：
    *   介绍如何利用 LLM 辅助进行 ASVS 预检（例如：把代码片段喂给 AI，让它对照 ASVS 具体条目进行 Review）。
    *   **治理视角**：使用 ASVS 作为企业级 AI 软件产品的安全准入红线。
