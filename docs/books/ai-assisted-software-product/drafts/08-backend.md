# 第 8 章：后端架构：服务边界、数据与可观测性

## 本章目标

- 用清晰的服务边界支撑快速迭代与稳定交付
- 把“用户/权限/付费/文档/检索/对话”拆成可演进的模块
- 用可观测性与可靠性机制把风险前置

## 章节结构（大纲）

### 8.1 服务边界与分层

- 分层：API/应用层/领域层/基础设施
- 服务边界：用户、计费、内容、检索、对话、评测

### 8.2 API 设计与契约

- REST/GraphQL/gRPC 的取舍
- 契约优先：OpenAPI、错误码、幂等性、版本管理

### 8.3 数据建模与一致性

- 核心实体：User、Workspace、Document、Chunk、Embedding、Conversation、Subscription
- 一致性策略：事务、最终一致、Outbox、幂等消费

### 8.4 可观测性与可靠性

- 日志/指标/链路追踪（Tracing）
- SLO/SLA、告警策略、容量规划、降级与熔断

## 本章交付物

- 领域模型与数据库 ER 草图
- 接口契约（OpenAPI 初版）
- 观测指标（latency/error/cost）与告警阈值建议

!!! tip "AI 提示词（复制即用）"
    你是后端架构师。基于“知识助理 SaaS”的模块（用户、文档、检索、对话、计费），请输出：1) 服务边界与分层建议；2) 核心实体与关系；3) API 契约的关键端点清单（含幂等与错误码）；4) 可观测性指标与 SLO 建议。用 Markdown 输出。

